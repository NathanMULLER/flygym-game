.. FlyGym documentation master file, created by
   sphinx-quickstart on Sat Apr  1 16:03:08 2023.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

FlyGym: Gymnasium environments for NeuroMechFly
===============================================


.. toctree::
   :maxdepth: 2
   :hidden:

   neuromechfly
   installation
   environments/index
   arena/index
   state
   changelog
   develop

`GitHub Repository <https://github.com/NeLy-EPFL/flygym>`_

.. warning::
   
   This package is still under development. **Only the MuJoCo version is available**. The API is subject to change.


This package implements `Gymnasium`_ environments for NeuroMechFly (`paper`_, `code`_), a neuromechanical model of the fruit fly *Drosophila melanogaster*.

Gymnasium is "a standard API [(Application Programming Interface)] for reinforcement learning, and a diverse collection of reference environments."

The environments in this package serve as wrappers to provide a unified interface to interact with fly model in different physics simulators (MuJoCo, Isaac Gym, PyBullet). The goal is to provide a consolidated API like the following to interact with the fly simulation::

   env = MyEnvironment(...)
   obs = env.reset()

   for step in range(1000):
      action = ...    # your controller decides what to do based on obs
      obs, reward, terminated, truncated, info = env.step(action)
      env.render()
      if terminated or truncated:
         break

   env.close()


References and notes
--------------------
- This package (including model files and mesh files) is based on the original NeuroMechFly publication: Lobato-Rios, V., Ramalingasetty, S. T., Ã–zdil, P. G., Arreguit, J., Ijspeert, A. J., & Ramdya, P. (2022). NeuroMechFly, a neuromechanical model of adult *Drosophila melanogaster*. *Nature Methods*, 19(5), 620-627. https://doi.org/10.1038/s41592-022-01466-7
- The XML file defining the MuJoCo model is modified from an XML file generated by `FARMS`_ (specifically `farms_mujoco`_).
- The documentation includes content generated by GitHub Copilot and ChatGPT.



.. _Gymnasium: https://gymnasium.farama.org/
.. _paper: https://doi.org/10.1038/s41592-022-01466-7
.. _code: https://github.com/NeLy-EPFL/NeuroMechFly
.. _FARMS: https://gitlab.com/farmsim
.. _farms_mujoco: https://gitlab.com/farmsim/farms_mujoco
